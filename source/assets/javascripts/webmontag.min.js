var map,eventBox;(function($){"use strict";map={options:{canvas:null,markers:null,map:{zoom:13,mapTypeId:google.maps.MapTypeId.ROADMAP,backgroundColor:"#fff"},marker:{},infobox:{pixelOffset:new google.maps.Size(-145,0),boxStyle:{width:"290px"},boxClass:"infobox",closeBoxMargin:"5px",closeBoxURL:"/assets/images/close.png"}},initMapInstance:function(){if(!this.mapInstance)this.mapInstance=new google.maps.Map(this.options.canvas[0],this.options.map);return this.mapInstance},initMapMarkers:function(){var markers=this.options.markers,self=this;markers.each(function(){var el=$(this),loc=el.data("loc").split(",");if(!loc)return;var position=new google.maps.LatLng(parseFloat(loc[0]),parseFloat(loc[1]));if(!self.mapInstance.getCenter())self.mapInstance.setCenter(position);var title=el.data("title")||"";var marker=self.addMarkerToMap(position,title);var content=el.html();if(!content)return;self.addInfoBoxToMarker(content,marker)})},addMarkerToMap:function(position,title){var options=$.extend({},{position:position,title:title||"",map:this.mapInstance},this.options.marker);return new google.maps.Marker(options)},addInfoBoxToMarker:function(content,marker){if(!content||!marker)return;if(!this.infobox)this.infobox=new InfoBox;var options=$.extend({},{content:content},this.options.infobox);var self=this;google.maps.event.addListener(marker,"click",function(){self.infobox.close();self.infobox.setOptions(options);self.infobox.open(self.mapInstance,marker)})},init:function(options){$.extend(true,this.options,options);if(!this.options.canvas)return false;this.initMapInstance();if(this.options.markers)this.initMapMarkers()}};eventBox={resizeTriangle:function(){$(".triangle").each(function(){var triangle=$(this);var width=triangle.parent().width()/2;triangle.css({"border-left-width":width,"border-right-width":width})})},init:function(){this.resizeTriangle();$(window).resize(this.resizeTriangle)}};$.fn.fancyScroll=function(speed){var _speed=speed||300;this.each(function(){$(this).click(function(e){if(!this.hash)return;$("body, html").animate({scrollTop:$(this.hash).offset().top},_speed);e.preventDefault()})})};$(document).ready(function(){var mapOptions={canvas:$("#map-canvas"),markers:$("#map-markers > div"),map:{scrollwheel:false},marker:{icon:new google.maps.MarkerImage("assets/images/marker.png",new google.maps.Size(20,40),new google.maps.Point(0,0),new google.maps.Point(10,40)),shadow:new google.maps.MarkerImage("assets/images/marker.png",new google.maps.Size(44,40),new google.maps.Point(20,0),new google.maps.Point(12,40)),animation:google.maps.Animation.DROP}};map.init(mapOptions);eventBox.init();$("a[href=#page], a[href=#contact]").fancyScroll()})})(jQuery);